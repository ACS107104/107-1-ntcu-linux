Hw-10

1.使用systemctl status指令檢查sshd系統服務狀態
"systemctl status sshd"(圖1)

2.用locate 查找關於sshd的設定
**centos在安裝完用locate命令發現找不到該指令,最近的centos用mlocate來取代locate的命令
#yum install mlocate
#updatedb
(打完安裝指令就可以執行locate的命令)
#locate sshd(圖2)

3
要使用systemd管理兩個sshd,一個的port22，另外一個複製後改成2222
#cd /etc/ssh
#cp sshd_config sshd2.config
#vi sshd2_config(圖3)
(把#port22改為port2222)
4.
#cd /etc/systemd/system
進入system目錄下
#cp /usr/lib/systemd/system/sshd.service sshd2.service(圖4)
#vi sshd2.service
#在ExecStart=/usr/sbin/sshd -f /etc/ssh/sshd2 config -D $OPTIONS 

5.#semanage port -a -t ssh_port_t -p tcp 2222
會出現錯誤訊息CentOS
(有使用SELinux ，故預設只允許 SSH 使用埠號 22，若要使用埠號 2222，請使用指令開啟並檢查)
下載semanage# yum install policycoreutils-python
使用systemctl daemon-reload後再使用systemctl start sshd2後，會發現無法順利開啟
(要先關閉防火牆)圖5
先安裝#yum install firewalld
檢查服務狀態#systemctl status firewalld 
再來關閉#systemctl stop firewalld
CentOS預設的防火牆firewalld會禁止訪問埠號2222，若要透過2222埠連ssh，請先關閉firewalld。
#firewall-cmd --permanent --zone=public --add-port=2222/tcp會出現success
#firewall-cmd --reload會出現success
最後再輸入
#systemctl daemon-reload
#systemctl start sshd2
#netstat -alntp | grep ssh(圖6)

